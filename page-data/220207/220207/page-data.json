{"componentChunkName":"component---src-templates-post-template-tsx","path":"/220207/220207/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<h1>OAuth 2.0</h1>\n<p>OAuth를 쓰는 이유에 대해 프론트엔드 개발자 그리고 기획자의 입장에서 생각해보면 OAuth는 쉽고 빠른 회원가입과 로그인을 유저에게 제공할 수 있다는 점입니다.</p>\n<p>또한 로그인, 개인정보 등에 관한 관리 책임을 서드 파티 애플리케이션(구글, 카카오, 네이버 등)에게 위임 할 수 있다는 점도 장점입니다.</p>\n<p>특히 신규 서비스의 경우, 유저의 진입장벽을 낮추고 또한 보안에 대한 리스크도 줄일 수 있다는 점에 Oauth가 합리적인 방식이라는 생각도 했습니다.</p>\n<p>Oauth란 인터넷 사용자들이 비밀번호를 제공하지 않고 다른 웹사이트 상의 자신들의 정보에 대해 웹사이트나 애플리케이션의 접근 권한을 부여할 수 있는 공통적인 수단으로서 사용되는, 접근 위임을 위한 개방형 표준이라고 합니다.\n<br/></p>\n<h1>1. Oauth 작동 방식</h1>\n<h3>Oauth 참여자</h3>\n<p>Oauth 동작에는 크게 세 가지의 참여자로 분류할 수 있습니다.</p>\n<ul>\n<li>Client: OAuth 2.0을 사용하여 로그인 기능을 구현할 웹 어플리케이션 입니다.</li>\n<li>Resource Server: Client가 제어하고자 하는 자원을 보유하고 있는 서드파티 애플리케이션입니다.</li>\n<li>Authorization Server: 권환을 부여하는 서버입니다. 구글의 경우 Access Token을 부여합니다.</li>\n<li>Resource Owner: Client가 제공하는 서비스 사용자이자, 서드파티 애플리케이션에 정보를 저장하고 있는 유저입니다.\n<br/></li>\n</ul>\n<h3>동작 방식</h3>\n<p>아래의 동작 방식은 이번 프로젝트에서 제가 구현한 로직입니다. 이는 OAuth 구현 방식의 한가지 방식에 불과하며, 절대적인 방식은 아닙니다.\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 768px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/f59ed870c77d7c5a4a3bdf04648623c5/c4688/2.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 64.0625%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAANCAYAAACpUE5eAAAACXBIWXMAAAsTAAALEwEAmpwYAAABrElEQVQ4y32TP47UMBTG5wgUXGEPQEOLKFYIiR4qxDYIaStOQAdXoIYLQMWeYAUFEkigbZZmpJFmhkyc+F/i8do/ZGcym81meJLj2PL73vd9z54BxBhvjT6m9qfWfcyGi2GMgQ8VGIPP0mfrWrQo0ZXIszVmDxC8Q2uNlBLnHP+LBJoB33/4yJ0Hjzh6eMzde/d5+uIkHzDGYmpBURSsViuKTYF3HmFLzuaf2agCLTVVXWF2JDLgpy9nPD59zbOXr3jy/IQ3b991gNaiRMF8PmexWKCUom1apK25EL9QVqKVxhhN27Y7DzuyEALbxtIoNRaSpaaEMPI0sRra0ElOhg4OWWtpnSNsW6qqopaSK+97Q1FVsmBDLWuaHasbTYndTk5K1dJIDWi1zIBCiD2LGALeuVykrkRuZmI+vD57yUbVLJdLyrLMUvSg070rfZLWJisQxZrVek0I4bDkPlJlbRpU0/kbYuAqhmxJGlNX5obk25c08ld6vv1UcHHOj8s//P76HRrDVM615InnNHwh3gdI8tSWxrhcKA4YjV/T7BD1PMc4tO/6/wBYAvwHpNPrvazRAU0AAAAASUVORK5CYII='); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/f59ed870c77d7c5a4a3bdf04648623c5/a59e9/2.webp 192w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/0ca9f/2.webp 384w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/dc9b9/2.webp 768w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/e2c2f/2.webp 1152w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/c47e4/2.webp 1179w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/webp\">\n          <source srcset=\"/static/f59ed870c77d7c5a4a3bdf04648623c5/3b721/2.png 192w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/66595/2.png 384w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/fe486/2.png 768w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/d2d74/2.png 1152w,\n/static/f59ed870c77d7c5a4a3bdf04648623c5/c4688/2.png 1179w\" sizes=\"(max-width: 768px) 100vw, 768px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/f59ed870c77d7c5a4a3bdf04648623c5/fe486/2.png\" alt=\"2\" title=\"2\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span></p>\n<h1>2. Oauth 구현</h1>\n<h3>0. 구글 콘솔 등록</h3>\n<p>하단의 이미지와 같이 해당 링크 <a href=\"https://console.cloud.google.com/apis/\" target=\"_blank\" rel=\"nofollow\">구글 API 및 서비스</a>를 통해 OAuth 2.0 클라이언트 ID를 발급 받으실 수 있습니다.\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 597px; \">\n      <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 48.958333333333336%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsTAAALEwEAmpwYAAABZUlEQVQoz62RW2sUQRCF5///C0WfBIOIYrLxIRIfJJAH30xYdp1b5tIz0z0zO9ee+aQaVtcQhIAHDl3VfbrqdLX34vwHrz9veXW55eXmnnc3ivNbxYere86+BLy98nl/HXDxLWRzfcenmwfefH3g423B5rvh4hE9nUd0taKpUrSKAQusMFTYecEOE3acGboJW6ZAz9xrYOIpeJWu0aamaQ/UTUtZGVRRUiUhOvmJTnyKaI+JtzThHaaZMN2Kbi39aLF2YT6hl2UZaZqS57lbJZc4VwW5KslUQZykZEVFoWvSciLIRqJ8pB8X52pd1z8OkyTBWsv/ghfHMW3b0jSNKzzPM9M0/ZOiEb0xhr7vf9+R1TkU+r5PWZaO0kCEXdc9yWEY3GiCIHB6yY9nniRSYFkWDoeDi484nc0pHu//NUOlFHVdO5fyGdJZ9qTRUfwcevv93hXZ7XaEYeieEUWRcysQ58/hLxPs/tWrCRkOAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/6bf517b82eb596c4c250a953c40f8d77/a59e9/3.webp 192w,\n/static/6bf517b82eb596c4c250a953c40f8d77/0ca9f/3.webp 384w,\n/static/6bf517b82eb596c4c250a953c40f8d77/789cc/3.webp 597w\" sizes=\"(max-width: 597px) 100vw, 597px\" type=\"image/webp\">\n          <source srcset=\"/static/6bf517b82eb596c4c250a953c40f8d77/3b721/3.png 192w,\n/static/6bf517b82eb596c4c250a953c40f8d77/66595/3.png 384w,\n/static/6bf517b82eb596c4c250a953c40f8d77/f523d/3.png 597w\" sizes=\"(max-width: 597px) 100vw, 597px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/6bf517b82eb596c4c250a953c40f8d77/f523d/3.png\" alt=\"3\" title=\"3\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n    </span></p>\n<p>사용자 인증 정보 만들기 > OAuth 클라이언트 ID 만들기 > 동의 화면 만들기 > 승인된 리디렉션 URI 설정\n위의 순서대로 진행하면 클라이언트 ID를 발급받으실 수 있습니다.</p>\n<ul>\n<li>REDIRECT URI는 리다이렉트 되는 주소로 프론트엔드와 백엔드가 합의해서 동일한 주소를 가져야 합니다.</li>\n<li>CLIENT ID : 클라이언트를 구별할 수 있는 식별자입니다.</li>\n<li>CLIENT SECRET : CLIENT ID에 대한 노출하면 안되는 비밀키 입니다.\n<br/></li>\n</ul>\n<h3>1. 인증 코드(Access Token) 요청</h3>\n<p><a href=\"https://developers.google.com/identity/protocols/oauth2/javascript-implicit-flow#oauth-2.0-endpoints\" target=\"_blank\" rel=\"nofollow\">클라이언트 측 웹 애플리케이션용 OAuth 2.0</a>에 따르면, <code class=\"language-text\">GET</code>으로 아래의 url을 통해 인증코드를 받아올 수 있습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">https://accounts.google.com/o/oauth2/v2/auth?scope={SCOPE}&amp;client_id=${CLIENT_ID}&amp;response_type=code&amp;redirect_uri=${REDIRECT_URI}&amp;access_type=offline</code></pre></div>\n<ul>\n<li>이때, CLIENT_ID는 구글 OAuth 2.0의 클라이언트 ID를 넣어주면 됩니다. SCOPE은 받아올 데이터의 범위를 의미합니다.\n<br/></li>\n</ul>\n<h3>2. 인증 코드를 받아서 백엔드로 전달</h3>\n<p>이후 인증코드는 리다이렉트 URI를 통해 아래의 이미지와 같이 파라미터로 전달됩니다.\n<span class=\"gatsby-resp-image-wrapper\" style=\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 290px; \">\n      <a class=\"gatsby-resp-image-link\" href=\"/static/881528df27336b13c54b5efb3f73af4c/bd800/4.png\" style=\"display: block\" target=\"_blank\" rel=\"noopener\">\n    <span class=\"gatsby-resp-image-background-image\" style=\"padding-bottom: 7.8125%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAACCAYAAABYBvyLAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAb0lEQVQI1z2MWwqEMAxF3f8WFJHYEltE++6UQWZpd0g+/Dic3OSSqZSGMb6otSPG/DrnipSKWnIICfcd0doHz/PT3XUF9D60J3f5M83zin238P6EMazzcXi1YC0rRBZERnHuxLYRlmUFswez0474D6seeKHgmEUCAAAAAElFTkSuQmCC'); background-size: cover; display: block;\"></span>\n  <picture>\n          <source srcset=\"/static/881528df27336b13c54b5efb3f73af4c/a59e9/4.webp 192w,\n/static/881528df27336b13c54b5efb3f73af4c/7c2e1/4.webp 290w\" sizes=\"(max-width: 290px) 100vw, 290px\" type=\"image/webp\">\n          <source srcset=\"/static/881528df27336b13c54b5efb3f73af4c/3b721/4.png 192w,\n/static/881528df27336b13c54b5efb3f73af4c/bd800/4.png 290w\" sizes=\"(max-width: 290px) 100vw, 290px\" type=\"image/png\">\n          <img class=\"gatsby-resp-image-image\" src=\"/static/881528df27336b13c54b5efb3f73af4c/bd800/4.png\" alt=\"4\" title=\"4\" loading=\"lazy\" decoding=\"async\" style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\">\n        </picture>\n  </a>\n    </span></p>\n<p>리액트의 경우 query-string 라이브러리를 통해 쉽게 code를 받아올 수 있습니다. 전달받은 <code class=\"language-text\">code</code>값은 백엔드로 전달합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"javascript\"><pre class=\"language-javascript\"><code class=\"language-javascript\"><span class=\"token keyword\">const</span> parsed <span class=\"token operator\">=</span> queryString<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>location<span class=\"token punctuation\">.</span>search<span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> code <span class=\"token operator\">=</span> parsed<span class=\"token punctuation\">.</span>code\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">getToken</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> res <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> 로컬호스트_API <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>err<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// 에러핸들링</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<br/>\n<h3>3. 백엔드에서 서비스 자체의 토큰을 클라이언트로 전달</h3>\n<p>백엔드는 클라이언트로 부터 받은 인증 코드를 통해, 구글로 부터 토큰을 받아오고 자체 토큰으로 재발행하여 클라이언트로 넘겨주면 됩니다.\n<br/></p>\n<h1>4. 끝맺음</h1>\n<p>팀 프로젝트를 진행하면서 Oauth를 적용해볼 기회가 생겼으나 동작방식에 대해 이해하는 것이 쉽지는 않았습니다. 그리고 제가 구현한 방식 또한 하나의 예시일 뿐이며 OAuth 구현방식은 다양하다고 볼 수 있습니다. 이번 백엔드와 프론트엔드가 다른 리다이렉트 URI를 사용하고 있어, 고생하기도 했습니다. 이번 프로젝트에서 리다이렉트 URI의 역할이 무엇인지 확고하게 알 수 있게 되었습니다.</p>\n<br/>\n<h4>참고</h4>\n<ul>\n<li><a href=\"https://developers.google.com/identity/protocols/oauth2/javascript-implicit-flow#oauth-2.0-endpoints\" target=\"_blank\" rel=\"nofollow\">클라이언트 측 웹 애플리케이션용 OAuth 2.0</a></li>\n<li><a href=\"https://2dowon.netlify.app/react/social_login/\" target=\"_blank\" rel=\"nofollow\">REACT로 카카오, 네이버 소셜 로그인 구현하기</a></li>\n</ul>","frontmatter":{"title":"[프로젝트] ssafe #2 React OAuth 로그인 구현하기","summary":"구글 Ouath 관련 내용을 정리한 글입니다.","date":"2022.02.07.","categories":["프론트엔드","프로젝트"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAhklEQVQoz2P4T2XAQBcD//37B6chbHQ+Qg1BAxEK//3/CzXg79+/cEzIUJwuxOEADJcS5cK/UMVbzvz8v//St//nz574v3f/wf/LV6z6v3fffryGMuCz/ej1X//vPf/1/97dW/8vXrry//LlK//v3LlLmoGYYUmaHF4XYosUECbLhYMmYQMAKLplmO7aZ+kAAAAASUVORK5CYII="},"images":{"fallback":{"src":"/static/5b966b032eb9105217f6346f59d30bd5/e018d/thumbnail.png","srcSet":"/static/5b966b032eb9105217f6346f59d30bd5/c6b60/thumbnail.png 480w,\n/static/5b966b032eb9105217f6346f59d30bd5/f5e84/thumbnail.png 960w,\n/static/5b966b032eb9105217f6346f59d30bd5/e018d/thumbnail.png 1920w","sizes":"(min-width: 1920px) 1920px, 100vw"},"sources":[{"srcSet":"/static/5b966b032eb9105217f6346f59d30bd5/0df1a/thumbnail.webp 480w,\n/static/5b966b032eb9105217f6346f59d30bd5/eeb31/thumbnail.webp 960w,\n/static/5b966b032eb9105217f6346f59d30bd5/702da/thumbnail.webp 1920w","type":"image/webp","sizes":"(min-width: 1920px) 1920px, 100vw"}]},"width":1920,"height":1080}},"publicURL":"/static/5b966b032eb9105217f6346f59d30bd5/thumbnail.png"}}}}]}},"pageContext":{"slug":"/220207/220207/"}},"staticQueryHashes":[]}