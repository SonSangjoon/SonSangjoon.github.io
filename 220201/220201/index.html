<!DOCTYPE html><html><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="ie=edge"/><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"/><meta name="generator" content="Gatsby 4.24.4"/><meta data-react-helmet="true" name="description" content="리코링 공식문서를 참고하여 공부한 내용을 정리한 문서입니다."/><meta data-react-helmet="true" name="viewport" content="width=device-width, initial-scale=1.0"/><meta data-react-helmet="true" http-equiv="Content-Type" content="text/html;charset=UTF-8"/><meta data-react-helmet="true" property="og:type" content="website"/><meta data-react-helmet="true" property="og:title" content="[TIL] Recoil 기본개념"/><meta data-react-helmet="true" property="og:description" content="리코링 공식문서를 참고하여 공부한 내용을 정리한 문서입니다."/><meta data-react-helmet="true" property="og:image" content="/static/6deb13a4701e6b5f9144251f6c7f93aa/thumbnail.png"/><meta data-react-helmet="true" property="og:url"/><meta data-react-helmet="true" property="og:site_name" content="[TIL] Recoil 기본개념"/><meta data-react-helmet="true" name="twitter:card" content="summary"/><meta data-react-helmet="true" name="twitter:title" content="[TIL] Recoil 기본개념"/><meta data-react-helmet="true" name="twitter:description" content="리코링 공식문서를 참고하여 공부한 내용을 정리한 문서입니다."/><meta data-react-helmet="true" name="twitter:image" content="/static/6deb13a4701e6b5f9144251f6c7f93aa/thumbnail.png"/><meta data-react-helmet="true" name="twitter:site" content="@onshore"/><meta data-react-helmet="true" name="twitter:creator" content="@onshore"/><meta data-react-helmet="true" name="google-site-verification" content="l_X8ULwc4eWGYMjn3ZB55i23MJF9Gg9FjVe57qbYfxk"/><style data-href="/styles.0109ae7f897db2fecdd6.css" data-identity="gatsby-global-css">code[class*=language-],pre[class*=language-]{word-wrap:normal;background:none;color:#ccc;font-family:Consolas,Monaco,Andale Mono,Ubuntu Mono,monospace;font-size:1em;-webkit-hyphens:none;-ms-hyphens:none;hyphens:none;line-height:1.5;-o-tab-size:4;tab-size:4;text-align:left;white-space:pre;word-break:normal;word-spacing:normal}pre[class*=language-]{margin:.5em 0;overflow:auto;padding:1em}:not(pre)>code[class*=language-],pre[class*=language-]{background:#2d2d2d}:not(pre)>code[class*=language-]{border-radius:.3em;padding:.1em;white-space:normal}.token.block-comment,.token.cdata,.token.comment,.token.doctype,.token.prolog{color:#999}.token.punctuation{color:#ccc}.token.attr-name,.token.deleted,.token.namespace,.token.tag{color:#e2777a}.token.function-name{color:#6196cc}.token.boolean,.token.function,.token.number{color:#f08d49}.token.class-name,.token.constant,.token.property,.token.symbol{color:#f8c555}.token.atrule,.token.builtin,.token.important,.token.keyword,.token.selector{color:#cc99cd}.token.attr-value,.token.char,.token.regex,.token.string,.token.variable{color:#7ec699}.token.entity,.token.operator,.token.url{color:#67cdcc}.token.bold,.token.important{font-weight:700}.token.italic{font-style:italic}.token.entity{cursor:help}.token.inserted{color:green}</style><title data-react-helmet="true">[TIL] Recoil 기본개념</title><style>.gatsby-image-wrapper{position:relative;overflow:hidden}.gatsby-image-wrapper picture.object-fit-polyfill{position:static!important}.gatsby-image-wrapper img{bottom:0;height:100%;left:0;margin:0;max-width:none;padding:0;position:absolute;right:0;top:0;width:100%;object-fit:cover}.gatsby-image-wrapper [data-main-image]{opacity:0;transform:translateZ(0);transition:opacity .25s linear;will-change:opacity}.gatsby-image-wrapper-constrained{display:inline-block;vertical-align:top}</style><noscript><style>.gatsby-image-wrapper noscript [data-main-image]{opacity:1!important}.gatsby-image-wrapper [data-placeholder-image]{opacity:0!important}</style></noscript><script type="module">const e="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;e&&document.body.addEventListener("load",(function(e){if(void 0===e.target.dataset.mainImage)return;if(void 0===e.target.dataset.gatsbyImageSsr)return;const t=e.target;let a=null,n=t;for(;null===a&&n;)void 0!==n.parentNode.dataset.gatsbyImageWrapper&&(a=n.parentNode),n=n.parentNode;const o=a.querySelector("[data-placeholder-image]"),r=new Image;r.src=t.currentSrc,r.decode().catch((()=>{})).then((()=>{t.style.opacity=1,o&&(o.style.opacity=0,o.style.transition="opacity 500ms linear")}))}),!0);</script><link rel="sitemap" type="application/xml" href="/sitemap.xml"/><link rel="preconnect" href="https://www.googletagmanager.com"/><link rel="dns-prefetch" href="https://www.googletagmanager.com"/><link rel="canonical" href="https://sonsangjoon.github.io/220201/220201/" data-baseprotocol="https:" data-basehost="sonsangjoon.github.io"/></head><body><div id="___gatsby"><div style="outline:none" tabindex="-1" id="gatsby-focus-wrapper"><style data-emotion="css 13ku56z">.css-13ku56z{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;height:100%;}</style><main class="css-13ku56z e1uilex40"><style data-emotion="css 1vn8l36">.css-1vn8l36{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;position:fixed;width:100vw;height:52px;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;background-color:rgba(0, 0, 0, 0);-webkit-backdrop-filter:saturate(180%) blur(10px);backdrop-filter:saturate(180%) blur(10px);z-index:1000;}</style><header class="css-1vn8l36 e12n6hdc4"><style data-emotion="css y3na0w">.css-y3na0w{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-flex-wrap:wrap;-webkit-flex-wrap:wrap;-ms-flex-wrap:wrap;flex-wrap:wrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:768px;margin:12px auto;text-align:center;line-height:1.5;}@media (max-width: 768px){.css-y3na0w{width:100vw;font-size:12px;}}</style><div class="css-y3na0w e12n6hdc3"><style data-emotion="css sub5od">.css-sub5od{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;font-size:12px;-webkit-alig-items:center;-ms-flex-item-alig-items:center;alig-items:center;margin-left:20px;color:#333d48;-webkit-transition:all 150ms ease-out;transition:all 150ms ease-out;}.css-sub5od:hover{color:#b0b8c1;}</style><a class="css-sub5od e12n6hdc1" href="/"><style data-emotion="css 91h5px">.css-91h5px{font-size:21px;font-weight:bold;color:#3182f6;}</style><div class="css-91h5px e12n6hdc0">onshore.</div></a><style data-emotion="css 11peu4j">.css-11peu4j{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;gap:10px;margin:20px;}</style><div class="css-11peu4j e12n6hdc2"><a class="css-sub5od e12n6hdc1" href="/blog">blog</a><a href="https://peppermint-need-c5c.notion.site/Portfolio-4d52917684f04a7bae90479630a2fb73" target="_blank" class="css-sub5od e12n6hdc1">portfolio</a><a href="https://github.com/SonSangjoon" target="_blank" class="css-sub5od e12n6hdc1">github</a></div></div></header><style data-emotion="css-global 1rj6kj3">@import url(//spoqa.github.io/spoqa-han-sans/css/SpoqaHanSansNeo.css);*{padding:0;margin:0;box-sizing:border-box;font-family:'Spoqa Han Sans Neo','sans-serif';}html,body,#___gatsby{height:100%;}a,a:hover{color:inherit;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;}</style><style data-emotion="css 16cz9yp">.css-16cz9yp{position:relative;width:100%;height:400px;}@media (max-width: 768px){.css-16cz9yp{height:300px;}}</style><div class="css-16cz9yp e1qc3us31"><style data-emotion="css dkwb1y">.css-dkwb1y{z-index:-1;width:100%;height:400px;object-fit:cover;-webkit-filter:brightness(0.25);filter:brightness(0.25);}</style><div data-gatsby-image-wrapper="" style="position:absolute" class="gatsby-image-wrapper gatsby-image-wrapper-constrained css-dkwb1y e1qc3us30"><div style="max-width:1920px;display:block"><img alt="" role="presentation" aria-hidden="true" src="data:image/svg+xml;charset=utf-8,%3Csvg height=&#x27;1080&#x27; width=&#x27;1920&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; version=&#x27;1.1&#x27;%3E%3C/svg%3E" style="max-width:100%;display:block;position:static"/></div><img aria-hidden="true" data-placeholder-image="" style="opacity:1;transition:opacity 500ms linear" decoding="async" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAALCAYAAAB/Ca1DAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAaklEQVQoz81S0QqAIAz0/7/OMO0DEhb+gEx011PWS0Yk4V52sHG746bQudQvhCJS+xV3IyylVPx04NZyS1Fr1lQYY4RzC4yZYa2D1hNSSu8VHsvMjNV7EBFCCCDakHMeyPIZinwPZZjH3gGhaGj9xFPYuAAAAABJRU5ErkJggg==" alt=""/><picture><source type="image/webp" data-srcset="/static/6deb13a4701e6b5f9144251f6c7f93aa/0df1a/thumbnail.webp 480w,/static/6deb13a4701e6b5f9144251f6c7f93aa/eeb31/thumbnail.webp 960w,/static/6deb13a4701e6b5f9144251f6c7f93aa/702da/thumbnail.webp 1920w" sizes="(min-width: 1920px) 1920px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1920px) 1920px, 100vw" decoding="async" loading="lazy" data-src="/static/6deb13a4701e6b5f9144251f6c7f93aa/e018d/thumbnail.png" data-srcset="/static/6deb13a4701e6b5f9144251f6c7f93aa/c6b60/thumbnail.png 480w,/static/6deb13a4701e6b5f9144251f6c7f93aa/f5e84/thumbnail.png 960w,/static/6deb13a4701e6b5f9144251f6c7f93aa/e018d/thumbnail.png 1920w" alt="thumbnail"/></picture><noscript><picture><source type="image/webp" srcSet="/static/6deb13a4701e6b5f9144251f6c7f93aa/0df1a/thumbnail.webp 480w,/static/6deb13a4701e6b5f9144251f6c7f93aa/eeb31/thumbnail.webp 960w,/static/6deb13a4701e6b5f9144251f6c7f93aa/702da/thumbnail.webp 1920w" sizes="(min-width: 1920px) 1920px, 100vw"/><img data-gatsby-image-ssr="" data-main-image="" style="opacity:0" sizes="(min-width: 1920px) 1920px, 100vw" decoding="async" loading="lazy" src="/static/6deb13a4701e6b5f9144251f6c7f93aa/e018d/thumbnail.png" srcSet="/static/6deb13a4701e6b5f9144251f6c7f93aa/c6b60/thumbnail.png 480w,/static/6deb13a4701e6b5f9144251f6c7f93aa/f5e84/thumbnail.png 960w,/static/6deb13a4701e6b5f9144251f6c7f93aa/e018d/thumbnail.png 1920w" alt="thumbnail"/></picture></noscript><script type="module">const t="undefined"!=typeof HTMLImageElement&&"loading"in HTMLImageElement.prototype;if(t){const t=document.querySelectorAll("img[data-main-image]");for(let e of t){e.dataset.src&&(e.setAttribute("src",e.dataset.src),e.removeAttribute("data-src")),e.dataset.srcset&&(e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset"));const t=e.parentNode.querySelectorAll("source[data-srcset]");for(let e of t)e.setAttribute("srcset",e.dataset.srcset),e.removeAttribute("data-srcset");e.complete&&(e.style.opacity=1)}}</script></div><style data-emotion="css m1156n">.css-m1156n{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:768px;height:100%;margin:0 auto;padding:60px 0;color:#ffffff;}@media (max-width: 768px){.css-m1156n{width:100%;padding:40px 20px;}}</style><div class="css-m1156n e9cj2hr3"><style data-emotion="css 67iklr">.css-67iklr{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;-webkit-justify-content:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;width:40px;height:40px;border:1px solid rgb(222, 226, 230);border-radius:50%;background-color:rgb(255, 255, 255);box-shadow:rgb(0 0 0 / 10%) 0px 1px 3px;cursor:pointer;color:black;}.css-67iklr:hover{background-color:white;}</style><div class="css-67iklr e9cj2hr2"><style data-emotion="css r5uk6g">.css-r5uk6g{vertical-align:middle;shape-rendering:inherit;-webkit-transform:translate3d(0, 0, 0);-moz-transform:translate3d(0, 0, 0);-ms-transform:translate3d(0, 0, 0);transform:translate3d(0, 0, 0);stroke-width:2;stroke-linecap:round;stroke-linejoin:round;}</style><svg viewBox="0 0 24 24" width="24" height="24" xmlns="http://www.w3.org/2000/svg" fill="none" stroke="currentColor" class="css-r5uk6g esf3axk0"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg></div><style data-emotion="css 8arot">.css-8arot{display:-webkit-box;overflow:hidden;overflow-wrap:break-word;margin-top:auto;text-overflow:ellipsis;line-height:1.2;white-space:normal;-webkit-line-clamp:2;-webkit-box-orient:vertical;font-size:45px;font-weight:800;}@media (max-width: 768px){.css-8arot{font-size:30px;}}</style><div class="css-8arot e9cj2hr1">[TIL] Recoil 기본개념</div><style data-emotion="css 3gcnt2">.css-3gcnt2{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:justify;-webkit-justify-content:space-between;justify-content:space-between;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-top:10px;font-size:18px;font-weight:700;}@media (max-width: 768px){.css-3gcnt2{-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;-webkit-align-items:flex-start;-webkit-box-align:flex-start;-ms-flex-align:flex-start;align-items:flex-start;font-size:15px;font-weight:400;}}</style><div class="css-3gcnt2 e9cj2hr0"><div>프론트엔드 / TIL / 리코일</div><div>2022.02.01.</div></div></div></div><style data-emotion="css 1wsltzd">.css-1wsltzd{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;width:768px;margin:0 auto;padding:100px 0;word-break:break-all;line-height:1.8;font-size:16px;font-weight:400;}.css-1wsltzd p{padding:3px 0;}.css-1wsltzd h1,.css-1wsltzd h2,.css-1wsltzd h3,.css-1wsltzd h4{font-weight:800;margin-bottom:30px;line-height:1.5;}.css-1wsltzd *+h1,.css-1wsltzd *+h2,.css-1wsltzd *+h3{margin-top:20px;}.css-1wsltzd hr+h1,.css-1wsltzd hr+h2,.css-1wsltzd hr+h3{margin-top:0;}.css-1wsltzd h1{font-size:30px;}.css-1wsltzd h2{font-size:25px;}.css-1wsltzd h3{font-size:20px;}.css-1wsltzd img{width:768px;}.css-1wsltzd blockquote{margin:20px 0;padding:5px 15px;border-left:2px solid #000000;font-weight:800;}.css-1wsltzd ol,.css-1wsltzd ul{margin-left:40px;padding:10px 0;}.css-1wsltzd hr{border:1px solid #000000;margin:20px 0;}.css-1wsltzd a{color:#4263eb;-webkit-text-decoration:underline;text-decoration:underline;}.css-1wsltzd pre[class*='language-']{margin:30px 0;padding:15px;font-size:15px;}.css-1wsltzd pre[class*='language-']::-webkit-scrollbar-thumb{background:rgba(255, 255, 255, 0.5);border-radius:3px;}.css-1wsltzd code[class*='language-'],.css-1wsltzd pre[class*='language-']{tab-size:2;}@media (max-width: 768px){.css-1wsltzd{width:100%;padding:80px 20px;line-height:1.6;font-size:14px;}.css-1wsltzd h1{font-size:23px;}.css-1wsltzd h2{font-size:20px;}.css-1wsltzd h3{font-size:17px;}.css-1wsltzd img{width:100%;}.css-1wsltzd hr{margin:50px 0;}}</style><div class="css-1wsltzd eohsgcy0"><h1>1. Recoil 도입기</h1>
<p>UI와 로직을 분리하는 형태로 리액트 프로젝트 구조를 만들기에 적합한 전역 상태관리 라이브러리를 찾아보게 되었고 Recoil을 찾게 되었습니다.
또한 사용성을 위해 React의 Suspense 사용을 고려하고 있었기 때문에, loading state를 따로 관리해야하는 Redux보다 동시성 모드를 지원하는 Recoil로 사용하는 것이 적합하다고 생각했습니다.
무엇보다, Redux에서는 추가적인 api로 구현되었던 비동기 처리나 캐싱을 Recoil에서는 자체적으로 selector에서 지원을 해준다는 점은 쉬운 러닝커브와 맞물려 좋은 선택이라고 생각했습니다.</p>
<h3>Recoil의 철학</h3>
<p>보일러 플레이트가 적은 API이면서 React의 로컬 상태(useState, useReducer)와 유사한 간단한 인터페이스 제공합니다.
코드 상호간의 낮은 결합도를 통해 Code Splitting의 용의성을 확보할 수 있습니다.
파생 데이터를 사용함으로써 데이터를 사용하는 컴포넌트에서 임의로 데이터를 바꾸는 로직을 가져가지 않아도 됩니다.</p>
<h3>Core Concept</h3>
<ul>
<li>Flexible shared state: 유연하게 상태 관리</li>
<li>Derived data and queries: 파생 데이터 생성이 용이</li>
<li>App-wide state observation: 애플리케이션 단의 상태 Observation 가능</li>
</ul>
<h1>2. 주요 개념</h1>
<h3>상태관리란 무엇인가</h3>
<ul>
<li>
<p>상태:</p>
<ul>
<li>애플리케이션의 동작 방식을 설명하는 모든 데이터</li>
</ul>
</li>
<li>
<p>관리:</p>
<ul>
<li>최초 값(initial value)를 저장</li>
<li>현재 값(current value)를 읽기</li>
<li>값을 업데이트</li>
</ul>
</li>
</ul>
<p>기존 Context API는 확정되지 않은 수의 값을 저장하는데 적합하지 않습니다. State 관리라기보다 개념상 의존성 주입(dependency injection)에 가깝습니다.</p>
<h3>Atoms</h3>
<p>Atoms는 상태의 단위이며, 업데이트와 구독이 가능합니다. atom이 업데이트되면 각각의 구독된 컴포넌트는 새로운 값을 반영하여 다시 렌더링됩니다. atoms는 런타임에서 생성될 수도 있습니다. 동일한 atom이 여러 컴포넌트에서 사용되는 경우에는 모든 컴포넌트는 상태를 공유합니다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> themeState <span class="token operator">=</span> <span class="token function">atom</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'themeState'</span><span class="token punctuation">,</span>
  <span class="token keyword">default</span><span class="token operator">:</span> <span class="token number">14</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<ul>
<li>Atoms는 전역적으로 고유한 키가 필요합니다.</li>
<li>Atom을 설정할 때 Promise을 지정할 수 없으므로 비동기 함수를 사용하기 위해 selectors를 사용해야 합니다.</li>
</ul>
<h3>Selector</h3>
<p>atoms나 다른 selectors를 입력으로 받아들이는 순수 함수(pure function)입니다. 상위 atoms 또는 selector가 업데이터되면 하위의 selector함수도 다시 실행됩니다.
Selectors는 상태를 기반으로하는 파생 데이터를 계산하는데 사용됩니다. 이때 최소한의 상태 집합만 atoms에 저장하고 다른 파생 데이터는 selectors를 통해 계산하여 쓸모없는 상태의 보존을 방지합니다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> themeState <span class="token operator">=</span> <span class="token function">selector</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'themeColorState'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> get <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> theme <span class="token operator">=</span> <span class="token function">get</span><span class="token punctuation">(</span>themeState<span class="token punctuation">)</span>
    <span class="token keyword">return</span> theme <span class="token operator">===</span> <span class="token string">'light'</span> <span class="token operator">?</span> <span class="token string">'white'</span> <span class="token operator">:</span> <span class="token string">'dark'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre></div>
<ul>
<li><code class="language-text">get</code> 인자를 통해 atoms와 다른 selectors에 접근할 수 있습니다.</li>
<li>selector는 writable 하지 않기 때문에 useRecoilState()를 사용하지 않습니다.(사용가능한 경우도 있습니다.)</li>
</ul>
<h1>3. 비동기 데이터 쿼리</h1>
<p><code class="language-text">Promise</code>를 리턴하거나 <code class="language-text">async</code>함수를 사용하기만 하면 됩니다. 이때 React 랜더 함수가 동기이기 때문에, promise가 resolve 되기전에 랜더가 이뤄질 수 있습니다. 이때 React Suspense와 함께 동작할 수 있습니다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> currentUserNameQuery <span class="token operator">=</span> <span class="token function">selector</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'CurrentUserName'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> get <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
      <span class="token literal-property property">userID</span><span class="token operator">:</span> <span class="token function">get</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>name
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">CurrentUserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token function">useRecoilValue</span><span class="token punctuation">(</span>currentUserNameQuery<span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>userName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">}</span>

<span class="token keyword">function</span> <span class="token function">MyApp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>RecoilRoot<span class="token operator">></span>
      <span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Suspense fallback<span class="token operator">=</span><span class="token punctuation">{</span><span class="token operator">&lt;</span>div<span class="token operator">></span>Loading<span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span><span class="token punctuation">}</span><span class="token operator">></span>
        <span class="token operator">&lt;</span>CurrentUserInfo <span class="token operator">/</span><span class="token operator">></span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Suspense<span class="token operator">></span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>RecoilRoot<span class="token operator">></span>
  <span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre></div>
<h3>매개변수가 있는 쿼리</h3>
<p>매개변수를 기반으로 쿼리를 하고 싶은 경우, 아래와 같이 코드를 작성할 수 있습니다.</p>
<div class="gatsby-highlight" data-language="javascript"><pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> userNameQuery <span class="token operator">=</span> <span class="token function">selectorFamily</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token literal-property property">key</span><span class="token operator">:</span> <span class="token string">'UserName'</span><span class="token punctuation">,</span>
  <span class="token function-variable function">get</span><span class="token operator">:</span> <span class="token parameter">userID</span> <span class="token operator">=></span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> response <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">{</span> userID <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>response<span class="token punctuation">.</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> response<span class="token punctuation">.</span>error
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> response<span class="token punctuation">.</span>name
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token keyword">function</span> <span class="token function">UserInfo</span><span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> userID <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> userName <span class="token operator">=</span> <span class="token function">useRecoilValue</span><span class="token punctuation">(</span><span class="token function">userNameQuery</span><span class="token punctuation">(</span>userID<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div<span class="token operator">></span><span class="token punctuation">{</span>userName<span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">></span>
<span class="token punctuation">}</span></code></pre></div>
<h3>동시 요청(Concurrent Requests)</h3>
<p><code class="language-text">waitForAll</code>과 <code class="language-text">waitForNone</code>을 통해 다양한 작업을 수행할 수 있습니다.</p>
<h3>미리 가져오기 (Pre-Fetching)</h3>
<p><code class="language-text">getLoadable</code>을 활용하여 렌더링 이전에 받아오기를 수행하여 성능 문제를 해결할 수도 있습니다.</p>
<br/>
<h4>참고</h4>
<ul>
<li><a href="https://recoiljs.org/ko/docs/introduction/motivation" target="_blank" rel="nofollow">Recoil</a></li>
</ul></div><style data-emotion="css hx9xpc">@media (max-width: 768px){.css-hx9xpc{padding:0 20px;}}</style><div class="css-hx9xpc ei01o540"></div><style data-emotion="css 9w9jmx">.css-9w9jmx{display:grid;place-items:center;margin-top:auto;padding:50px 0;font-size:15px;text-align:center;line-height:1.5;}@media (max-width: 768px){.css-9w9jmx{font-size:13px;}}</style><footer class="css-9w9jmx e18uiaj80">Thank You for Visiting My Blog<br/>© 2022 onshore, Powered By Gatsby.</footer></main></div><div id="gatsby-announcer" style="position:absolute;top:0;width:1px;height:1px;padding:0;overflow:hidden;clip:rect(0, 0, 0, 0);white-space:nowrap;border:0" aria-live="assertive" aria-atomic="true"></div></div><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-F2FW9287D4"></script><script>
      
      
      if(true) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){window.dataLayer && window.dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'G-F2FW9287D4', {"send_page_view":false});
      }
      </script><script id="gatsby-script-loader">/*<![CDATA[*/window.pagePath="/220201/220201/";window.___webpackCompilationHash="780219ff0b0a83ed18ec";/*]]>*/</script><script id="gatsby-chunk-mapping">/*<![CDATA[*/window.___chunkMapping={"polyfill":["/polyfill-fc483b1bbdaa528b4195.js"],"app":["/app-eaff7ccb335ede7f0d1c.js"],"component---src-pages-404-tsx":["/component---src-pages-404-tsx-6eb45a3508afd9181a5c.js"],"component---src-pages-blog-tsx":["/component---src-pages-blog-tsx-120d85ab194dd996572a.js"],"component---src-pages-index-tsx":["/component---src-pages-index-tsx-3b709ef84c170ce062fc.js"],"component---src-pages-info-tsx":["/component---src-pages-info-tsx-9de2baf59b1d79299ace.js"],"component---src-pages-resume-tsx":["/component---src-pages-resume-tsx-5d280f20e5aac3d1884d.js"],"component---src-templates-post-template-tsx":["/component---src-templates-post-template-tsx-0373894eee88149e4419.js"]};/*]]>*/</script><script src="/polyfill-fc483b1bbdaa528b4195.js" nomodule=""></script><script src="/app-eaff7ccb335ede7f0d1c.js" async=""></script><script src="/framework-6dc8d1d4ccd1080b4b21.js" async=""></script><script src="/webpack-runtime-54774d440ef92af6c3e4.js" async=""></script></body></html>